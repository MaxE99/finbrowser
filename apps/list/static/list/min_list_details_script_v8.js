const subscribeButton=document.querySelector(".subscribeButton");function check_interaction_wrapper_at_last_spot(e,t){(spot=e.querySelectorAll(".contentWrapper").length)%(items_per_screen=getComputedStyle(e.querySelector(".slider")).getPropertyValue("--items-per-screen"))==0&&(t?e.querySelector(".slider").style.zIndex="":e.querySelector(".slider").style.zIndex="1000")}subscribeButton&&subscribeButton.addEventListener("click",async()=>{if(!subscribeButton.classList.contains("registrationLink"))try{let e=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1],t=subscribeButton.innerText,r=await fetch(`../../api/lists/${e}/list_change_subscribtion_status/`,get_fetch_settings("POST"));if(r.ok){let s=await r.json();"SUBSCRIBE"==t?(subscribeButton.classList.replace("unsubscribed","subscribed"),subscribeButton.innerText="Subscribed",showMessage(s,"Success")):(subscribeButton.classList.replace("subscribed","unsubscribed"),subscribeButton.innerText="Subscribe",showMessage(s,"Remove"))}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(l){}});const editButton=document.querySelector(".editButton"),listName=document.querySelector(".rightFirstRowContainer h3").innerText;function openEditMenu(){editButton.remove(),check_device_width_below(500)&&(document.querySelector(".notificationAndSubscribtionContainer .fa-bell").style.display="none"),document.querySelector(".rightFirstRowContainer h3").style.display="none",document.querySelector(".nameChangeContainer").style.display="block",document.querySelector(".nameChangeContainer #id_name").value=listName,document.querySelector(".listPictureContainer #id_list_pic").style.display="block",document.querySelector(".fa-camera").style.display="block",document.querySelector(".buttonContainer").style.display="flex",document.querySelector(".addSourcesButton").style.display="flex",document.querySelectorAll(".highlightedArticlesContainer .article .fa-ellipsis-h").forEach(e=>{e.style.display="none"});let e=document.querySelectorAll(".article .fa-times");e.forEach(e=>{e.style.display="block",e.addEventListener("click",async()=>{try{let t=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1],r=e.parentElement.id.split("#")[1],s=await fetch(`../../api/lists/${t}/delete_article_from_list/${r}/`,get_fetch_settings("DELETE"));if(s.ok){let l=await s.json();showMessage(l,"Remove"),e.parentElement.remove()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(i){}})}),document.querySelectorAll(".sourceDeleteOption").forEach(e=>{"none"!=e.style.display&&e.style.display||(e.style.display="block",e.addEventListener("click",async()=>{try{let t=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1],r=e.id.split("#")[1],s=await fetch(`../../api/lists/${t}/delete_source_from_list/${r}/`,get_fetch_settings("DELETE"));if(s.ok){let l=await s.json();showMessage(l,"Remove"),e.parentElement.parentElement.remove()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(i){}}))})}editButton&&editButton.addEventListener("click",openEditMenu);const sources=document.querySelectorAll(".slider-content li");1===sources.length&&openEditMenu(),document.querySelector(".deleteListButton")&&document.querySelector(".deleteListButton").addEventListener("click",async()=>{try{let e=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1],t=await fetch(`../../api/lists/${e}/`,get_fetch_settings("DELETE"));if(t.ok){let r=await t.json();showMessage(r,"Remove"),window.location.href="../../lists"}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(s){}}),document.querySelector(".addSourcesButton")&&document.querySelector(".addSourcesButton").addEventListener("click",()=>{document.querySelector(".addSourcesForm").style.display="flex",check_interaction_wrapper_at_last_spot(document.querySelector(".sliderWrapper"),!1)}),document.querySelector(".addSourcesForm .closeFormContainerButton")&&document.querySelector(".addSourcesForm .closeFormContainerButton").addEventListener("click",()=>{document.querySelector(".addSourcesForm").style.display="none",check_interaction_wrapper_at_last_spot(document.querySelector(".sliderWrapper"),!0)});let selected_sources=[];document.querySelector(".addSourcesForm #textInput")&&document.querySelector(".addSourcesForm #textInput").addEventListener("keyup",async function(e){let t=document.querySelector(".addSourcesForm #textInput").value,r=document.querySelector(".addSourcesForm #searchResultsContainer"),s=document.querySelector(".addSourcesForm .selectionContainer"),l=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1];if(t&&""!=t.replaceAll(/\s/g,"")){r.style.display="block",s.style.display="none";try{let i=await fetch(`../../api/sources/?list_search=${t}&list_id=${l}`,get_fetch_settings("GET"));if(i.ok){let o=await i.json();r.innerHTML="";let n=document.createElement("div");n.innerText="Results:",r.append(n),o.length>0&&o.forEach(e=>{if(!1==selected_sources.includes(e.source_id)){let t=document.createElement("div");t.classList.add("searchResult");let l=document.createElement("img");l.src=`https://finbrowser.s3.us-east-2.amazonaws.com/static/${e.favicon_path}`;let i=document.createElement("span");i.innerText=e.name,i.id=`source_id_${e.source_id}`,t.append(l,i),r.appendChild(t),t.addEventListener("click",function l(){t.removeEventListener("click",l),selected_sources.push(e.source_id);let i=document.createElement("i");i.classList.add("fas","fa-trash"),i.addEventListener("click",()=>{i.parentElement.remove(),selected_sources=selected_sources.filter(function(e){return e.toString()!==i.previousElementSibling.id.split("#")[1]})}),t.appendChild(i),s.appendChild(t),r.style.display="none",s.style.display="block",document.querySelector(".addSourcesForm #textInput").value=""})}})}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(c){}}else r.style.display="none",s.style.display="block"}),document.querySelector(".addSourcesForm button")&&document.querySelector(".addSourcesForm button").addEventListener("click",async()=>{let e=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1];if(selected_sources.length){selected_sources=selected_sources.join();try{let t=await fetch(`../../api/lists/${e}/add_sources/${selected_sources}/`,get_fetch_settings("POST"));if(t.ok){let r=await t.json();showMessage(r,"Success"),window.location.reload()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(s){}}else showMessage("You need to select sources!","Error")});const one=document.getElementById("first"),two=document.getElementById("second"),three=document.getElementById("third"),four=document.getElementById("fourth"),five=document.getElementById("fifth"),confirmBox=document.getElementById("confirm-box"),handleStarSelect=(e,t)=>{let r=t.children;for(let s=0;s<r.length;s++)s<e?r[s].classList.add("checked"):r[s].classList.remove("checked")},handleSelect=e=>{let t=document.querySelector(".rate-form");switch(e){case"first":handleStarSelect(1,t);return;case"second":handleStarSelect(2,t);return;case"third":handleStarSelect(3,t);return;case"fourth":handleStarSelect(4,t);return;case"fifth":handleStarSelect(5,t);return;default:handleStarSelect(0,t)}},getNumericValue=e=>{let t;return"first"===e?1:"second"===e?2:"third"===e?3:"fourth"===e?4:"fifth"===e?5:0};if(one){let e=[one,two,three,four,five];e.forEach(e=>e.addEventListener("mouseover",e=>{handleSelect(e.target.id)}))}if(document.querySelectorAll(".rankingStar").forEach(e=>{e.addEventListener("click",async e=>{let t=e.target.id,r=getNumericValue(t),s=document.querySelector(".rightFirstRowContainer h3").id.split("#")[1];try{let l={list_id:s,rating:r},i=await fetch("../../api/list_ratings/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(l)});if(i.ok){let o=await i.json();showMessage(o,"Success"),window.location.reload()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(n){}})}),document.querySelector(".avgRating span")){let t=Math.round(document.querySelector(".avgRating span").innerText);handleStarSelect(t,document.querySelector(".ratedContainer"))}const rateListButton=document.querySelector(".rateListButton");rateListButton&&rateListButton.addEventListener("click",()=>{rateListButton.classList.contains("registrationLink")||(document.querySelector(".rate-formUpperContainer").style.display="block",document.querySelector(".rating").style.opacity="0",document.querySelector(".ratingsAmmountContainer").style.opacity="0",document.querySelector(".rateListButton").style.opacity="0",document.querySelector(".rankingsHeader").style.opacity="0")});