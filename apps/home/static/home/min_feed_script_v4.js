let contentIsLoading=!1;function createTwitterPart(e,t){if("Retweet"===e.tweet_type.type){let n=document.createElement("div");n.className="retweetWrapper";let a=document.createElement("span");a.textContent=`@${e.tweet_type.author}`,n.appendChild(document.createTextNode("Retweeted post by ")),n.appendChild(a),t.appendChild(n)}if("Reply"===e.tweet_type.type){let r=document.createElement("div");r.className="replyWrapper";let l=document.createElement("span");l.textContent=`@${e.tweet_type.author}`,r.appendChild(document.createTextNode("Replying to ")),r.appendChild(l),t.appendChild(r)}if(e.tweet_type.image_path){let i=document.createElement("img");i.className="tweetImage",i.setAttribute("src","https://finbrowser.s3.us-east-2.amazonaws.com/static/"+e.tweet_type.image_path),i.setAttribute("alt","Tweet Image"),t.appendChild(i)}if("Quote"===e.tweet_type.type||"Retweet"===e.tweet_type.type||"Reply"===e.tweet_type.type){let o=document.createElement("div");o.className="quoteWrapper";let s=document.createElement("div");s.className="quoteUpperContainer";let c=document.createElement("div");c.className="quoteAuthor",c.textContent=e.tweet_type.author,s.appendChild(c),o.appendChild(s);let d=document.createElement("div");if(d.className="quoteText",d.textContent=e.tweet_type.text,o.appendChild(d),e.tweet_type.initial_tweet_img_path){let p=document.createElement("img");p.className="tweetImage",p.setAttribute("src","https://finbrowser.s3.us-east-2.amazonaws.com/static/"+e.tweet_type.initial_tweet_img_path),p.setAttribute("alt","Tweet Reply Image"),o.appendChild(p)}t.appendChild(o),t.appendChild(contentLink)}}function addNewContentToContainer(e,t=!1){let n=document.createElement("div");n.classList.add("articleContainer"),n.id="cc#"+e.article_id;let a=document.createElement("div");a.classList.add("leftContentSide");let r=document.createElement("div");r.classList.add("profileImageContainer");let l=document.createElement("img");l.src="https://finbrowser.s3.us-east-2.amazonaws.com/static/"+e.source.favicon_path;let i=document.createElement("a");i.classList.add("sourceProfile"),i.href="/source/"+e.source.slug,r.append(l,i),a.appendChild(r),n.appendChild(a);let o=document.createElement("div");o.classList.add("rightContentSide");let s=document.createElement("div");s.classList.add("contentInfoContainer");let c=document.createElement("div");c.classList.add("sourceAndWebsiteContainer");let d=document.createElement("a");d.classList.add("sourceProfile"),d.href="/source/"+e.source.slug,d.innerText=e.source.name;let p=document.createElement("div");p.classList.add("sourceWebsiteProfileContainer");let m=document.createElement("img");m.src="https://finbrowser.s3.us-east-2.amazonaws.com/static/"+e.source.website.logo;let C=document.createElement("a");C.href=e.source.url,p.append(m,C),c.append(d,p),s.appendChild(c);let h=document.createElement("i");h.classList.add("fas","fa-ellipsis-h"),document.querySelector(".articleContainer .fa-ellipsis-h").classList.contains("openAuthPrompt")&&(h.classList.add("openAuthPrompt","ap6"),h.addEventListener("click",()=>{openAuthPrompt(h)})),h.addEventListener("click",e=>{openContentOptionsMenu(e,h)});let u=document.createElement("div");u.classList.add("articleOptionsContainer");let w=document.createElement("div");w.classList.add("addToListButton");let g=document.createElement("i");g.classList.add("fas","fa-list");let E=document.createElement("span");E.innerText="Add to list",w.append(g,E),w.addEventListener("click",e=>{openAddToListMenu(e)});let f=document.createElement("div");f.classList.add("addToHighlightedButton");let y=document.createElement("i");y.classList.add("fas","fa-highlighter");let L=document.createElement("span");e.is_highlighted?L.innerText="Unhighlight Article":L.innerText="Highlight article",f.append(y,L),f.addEventListener("click",()=>{highlightContent(f)}),u.append(w,f),s.append(h,u);let v=document.createElement("div");v.classList.add("contentBody"),v.id="cc#"+e.article_id;let T=document.createElement("p");T.innerText=e.title,v.appendChild(T);let b=document.createElement("div");b.classList.add("timeContainer");let W=document.createElement("p");W.innerText=e.pub_date,b.appendChild(W),(contentLink=document.createElement("a")).classList.add("contentLink"),contentLink.href=e.link,o.append(s,v,contentLink),t?(createTwitterPart(e,o),o.appendChild(b),n.appendChild(o),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper").appendChild(n)):(o.appendChild(b),n.appendChild(o),document.querySelector(".pageWrapper .longFormContentContainer .recommendedContentContainer .smallFormContentWrapper").appendChild(n))}const scrollableContentContainer=document.querySelector(".pageWrapper .recommendedContentContainer .smallFormContentWrapper"),scrollableTweetContainer=document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper");async function createContent(){try{let e=document.querySelectorAll(".pageWrapper .longFormContentContainer .recommendedContentContainer .smallFormContentWrapper .articleContainer").length,t=await fetch(`../../api/articles/?feed_content=${e}`,get_fetch_settings("GET"));if(t.ok){let n=await t.json();n.forEach(e=>{addNewContentToContainer(e)}),document.querySelector(".recommendedContentContainer .loader").remove(),contentIsLoading=!1}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(a){}}async function createTweets(){try{let e=document.querySelectorAll(".pageWrapper .tweetsContainer .smallFormContentWrapper .articleContainer").length,t=await fetch(`../../api/articles/?best_tweets=${e}`,get_fetch_settings("GET"));if(t.ok){let n=await t.json();n.forEach(e=>{addNewContentToContainer(e,!0)}),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper .loader").remove(),contentIsLoading=!1}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(a){}}function contentScroll(){if(Math.ceil(scrollableContentContainer.scrollTop+scrollableContentContainer.clientHeight)>=scrollableContentContainer.scrollHeight&&!contentIsLoading){let e=document.createElement("div");e.classList.add("loader"),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper").appendChild(e),createTweets(),contentIsLoading=!0}else document.querySelector(".pageWrapper .longFormContentContainer .recommendedContentContainer").appendChild(loader),createContent(),contentIsLoading=!0}function twitterScroll(){if(Math.ceil(scrollableTweetContainer.scrollTop+scrollableTweetContainer.clientHeight)>=scrollableTweetContainer.scrollHeight&&!contentIsLoading){let e=document.createElement("div");e.classList.add("loader"),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper").appendChild(e),createTweets(),contentIsLoading=!0}}scrollableContentContainer.addEventListener("scroll",()=>{contentScroll()}),scrollableContentContainer.addEventListener("touchmove",()=>{contentScroll()}),scrollableTweetContainer.addEventListener("scroll",function(){twitterScroll()}),scrollableTweetContainer.addEventListener("touchmove",()=>{twitterScroll()});