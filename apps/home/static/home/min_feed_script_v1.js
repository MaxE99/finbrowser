let contentIsLoading=!1;function createTwitterPart(e,t){if("Retweet"===e.tweet_type.type){let a=document.createElement("div");a.className="retweetWrapper";let n=document.createElement("span");n.textContent=`@${e.tweet_type.author}`,a.appendChild(document.createTextNode("Retweeted post by ")),a.appendChild(n),t.appendChild(a)}if("Reply"===e.tweet_type.type){let r=document.createElement("div");r.className="replyWrapper";let l=document.createElement("span");l.textContent=`@${e.tweet_type.author}`,r.appendChild(document.createTextNode("Replying to ")),r.appendChild(l),t.appendChild(r)}if(e.tweet_type.image_path){let i=document.createElement("img");i.className="tweetImage",i.setAttribute("src",e.tweet_type.image_path),i.setAttribute("alt","Tweet Image"),t.appendChild(i)}if("Quote"===e.tweet_type.type||"Retweet"===e.tweet_type.type||"Reply"===e.tweet_type.type){let d=document.createElement("div");d.className="quoteWrapper";let o=document.createElement("div");o.className="quoteUpperContainer";let s=document.createElement("div");s.className="quoteAuthor",s.textContent=e.tweet_type.author,o.appendChild(s),d.appendChild(o);let c=document.createElement("div");if(c.className="quoteText",c.textContent=e.tweet_type.text,d.appendChild(c),e.tweet_type.initial_tweet_img_path){let p=document.createElement("img");p.className="tweetImage",p.setAttribute("src",e.tweet_type.initial_tweet_img_path),p.setAttribute("alt","Tweet Reply Image"),d.appendChild(p)}t.appendChild(d),t.appendChild(contentLink)}}function addNewContentToContainer(e,t=!1){let a=document.createElement("div");a.classList.add("articleContainer"),a.id="cc#"+e.article_id;let n=document.createElement("div");n.classList.add("leftContentSide");let r=document.createElement("div");r.classList.add("profileImageContainer");let l=document.createElement("img");l.src="/static/"+e.source.favicon_path;let i=document.createElement("a");i.classList.add("sourceProfile"),i.href="/source/"+e.source.slug,r.append(l,i),n.appendChild(r),a.appendChild(n);let d=document.createElement("div");d.classList.add("rightContentSide");let o=document.createElement("div");o.classList.add("contentInfoContainer");let s=document.createElement("div");s.classList.add("sourceAndWebsiteContainer");let c=document.createElement("a");c.classList.add("sourceProfile"),c.href="/source/"+e.source.slug,c.innerText=e.source.name;let p=document.createElement("div");p.classList.add("sourceWebsiteProfileContainer");let m=document.createElement("img");m.src="/static/"+e.source.website.logo;let C=document.createElement("a");C.href=e.source.url,p.append(m,C),s.append(c,p),o.appendChild(s);let h=document.createElement("i");h.classList.add("fas","fa-ellipsis-h"),document.querySelector(".articleContainer .fa-ellipsis-h").classList.contains("openAuthPrompt")&&(h.classList.add("openAuthPrompt","ap6"),h.addEventListener("click",()=>{openAuthPrompt(h)})),h.addEventListener("click",e=>{openContentOptionsMenu(e,h)});let u=document.createElement("div");u.classList.add("articleOptionsContainer");let g=document.createElement("div");g.classList.add("addToListButton");let E=document.createElement("i");E.classList.add("fas","fa-list");let w=document.createElement("span");w.innerText="Add to list",g.append(E,w),g.addEventListener("click",e=>{openAddToListMenu(e)});let y=document.createElement("div");y.classList.add("addToHighlightedButton");let L=document.createElement("i");L.classList.add("fas","fa-highlighter");let f=document.createElement("span");e.is_highlighted?f.innerText="Unhighlight Article":f.innerText="Highlight article",y.append(L,f),y.addEventListener("click",()=>{highlightContent(y)}),u.append(g,y),o.append(h,u);let v=document.createElement("div");v.classList.add("contentBody"),v.id="cc#"+e.article_id;let T=document.createElement("p");T.innerText=e.title,v.appendChild(T);let W=document.createElement("div");W.classList.add("timeContainer");let q=document.createElement("p");q.innerText=e.pub_date,W.appendChild(q),(contentLink=document.createElement("a")).classList.add("contentLink"),contentLink.href=e.link,d.append(o,v,contentLink),t?(createTwitterPart(e,d),d.appendChild(W),a.appendChild(d),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper").appendChild(a)):(d.appendChild(W),a.appendChild(d),document.querySelector(".pageWrapper .longFormContentContainer .recommendedContentContainer .smallFormContentWrapper").appendChild(a))}async function createContent(){try{let e=document.querySelectorAll(".pageWrapper .longFormContentContainer .recommendedContentContainer .smallFormContentWrapper .articleContainer").length,t=await fetch(`../../api/articles/?feed_content=${e}`,get_fetch_settings("GET"));if(t.ok){let a=await t.json();a.forEach(e=>{addNewContentToContainer(e)}),document.querySelector(".recommendedContentContainer .loader").remove(),contentIsLoading=!1}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(n){}}async function createTweets(){try{let e=document.querySelectorAll(".pageWrapper .tweetsContainer .smallFormContentWrapper .articleContainer").length,t=await fetch(`../../api/articles/?best_tweets=${e}`,get_fetch_settings("GET"));if(t.ok){let a=await t.json();a.forEach(e=>{addNewContentToContainer(e,!0)}),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper .loader").remove(),contentIsLoading=!1}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(n){}}window.addEventListener("scroll",()=>{let{scrollHeight:e,scrollTop:t,clientHeight:a}=document.documentElement;if(t+a>e-5&&!contentIsLoading){let n=document.createElement("div");n.classList.add("loader"),window.innerWidth<1001&&document.querySelector(".pageWrapper .tweetsContainer").classList.contains("tabsContentActive")?(document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper").appendChild(n),createTweets(),contentIsLoading=!0):(document.querySelector(".pageWrapper .longFormContentContainer .recommendedContentContainer").appendChild(n),createContent(),contentIsLoading=!0)}});const scrollableDiv=document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper");scrollableDiv.addEventListener("scroll",function(){if(Math.ceil(scrollableDiv.scrollTop+scrollableDiv.clientHeight)>=scrollableDiv.scrollHeight&&!contentIsLoading){let e=document.createElement("div");e.classList.add("loader"),document.querySelector(".pageWrapper .tweetsContainer .smallFormContentWrapper").appendChild(e),createTweets(),contentIsLoading=!0}});