async function changeSubscriptionStatusSR(e){if(!e.classList.contains("openAuthPrompt"))try{let t=e.closest(".sourceRankingContainer").id.split("#")[1],r=await fetch(`../../api/sources/${t}/`,getFetchSettings("PATCH"));r.ok?showSubscriptionStatus(e):showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}async function rateSourceSR(){let e=document.querySelector(".sourceRatingsWrapper").id,t=document.querySelector(".sourceRatingsWrapper .ratingsContainer .ratingsButtonContainer .selectedRating")?.innerText;if(t&&!isSourceBeingRated){isSourceBeingRated=!0;try{let r=await fetch("../../api/source_ratings/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify({source:e,rating:t})});r.ok?(showMessage("Rating has been saved!","Success"),window.location.reload()):showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}else t||isSourceBeingRated||showMessage("Select a rating!","Error")}function createDropdown(e,t,r){"website"!==e&&(t.closest("form").querySelector(".websiteList").style.display="none"),"sector"!==e&&(t.closest("form").querySelector(".sectorList").style.display="none"),"tag"!==e&&(t.closest("form").querySelector(".tagList").style.display="none");let o=r.tagName.toUpperCase();"LI"!==o&&"INPUT"!==o&&("block"!==r.querySelector("ul").style.display?r.querySelector("ul").style.display="block":r.querySelector("ul").style.display="none",document.onclick=r=>{("website"!==e||r.target.closest(".websiteList")||r.target===t)&&("sector"!==e||r.target.closest(".sectorList")||r.target===t)&&("tag"!==e||r.target.closest(".tagList")||r.target===t)||(t.querySelector("ul").style.display="none")})}function selectDropdown(e){"INPUT"!==e.tagName.toUpperCase()&&(e.querySelector("input").checked?e.querySelector("input").checked=!1:e.querySelector("input").checked=!0)}function openAddSourceToListsFormSR(e){if(setModalStyle(),!e.classList.contains("openAuthPrompt")){let t=e.closest(".sourceRankingContainer").id.split("#")[1],r=e.closest(".sourceRankingContainer").querySelector(".firstRow a span:last-of-type").innerText;document.querySelector(".fullScreenPlaceholder .addToListForm h3 span").innerText=r,document.querySelector(".fullScreenPlaceholder").style.display="flex",document.querySelector(".fullScreenPlaceholder .addSourceToListForm").style.display="block",document.querySelector(".fullScreenPlaceholder .addSourceToListForm").id="source_id"+t,resetAddSourceToListsForm(t),document.querySelector(".fullScreenPlaceholder .addSourceToListForm .cancelButton")?.addEventListener("click",()=>resetAddSourceToListsForm())}}function resetSourceRatingMenu(e){document.querySelectorAll(".sourceRatingsContainer .ratingsButtonContainer button").forEach(t=>{t.classList.remove("selectedRating"),t.innerText==e&&t.classList.add("selectedRating")})}function openSourceRatingMenu(e){let t=null;e.classList.contains("notRated")||document.querySelectorAll(".sourceRatingsContainer .ratingsButtonContainer button").forEach(r=>{r.innerText==e.innerText&&(r.classList.add("selectedRating"),t=e.innerText)}),document.querySelector(".sourceRatingsWrapper .ratingsContainer .cancelButton")?.addEventListener("click",()=>resetSourceRatingMenu(t));let r=e.closest(".sourceRankingContainer").querySelector(".firstRow a span:last-of-type").innerText,o=e.closest(".sourceRankingContainer").id.split("#")[1];document.querySelector(".sourceRatingsWrapper").id=o,document.querySelector(".sourceRatingsWrapper").style.display="flex",document.querySelector(".sourceRatingsWrapper .header h3").innerHTML=`Rate <span>${r}</span>`,setModalStyle()}function closeSourceRatingMenu(){document.querySelector(".sourceRatingsContainer .ratingsButtonContainer .selectedRating")?.classList.remove("selectedRating"),document.querySelector(".sourceRatingsWrapper").style.display="none",removeModalStyle()}function openTopSourceExplanation(){setModalStyle(),createExplanationContainer("Top Sources","I personally select Top Sources based on their outstanding analysis, insightful perspectives, and engaging content. These sources are my go-to for staying informed and entertained, and I highly recommend them."),document.querySelector(".fullScreenPlaceholder .fullScreenWrapper .explanationContainer .fa-times").addEventListener("click",()=>closeTopSourceExplanation())}function closeTopSourceExplanation(){removeModalStyle(),document.querySelector(".fullScreenPlaceholder").style.display="none",document.querySelector(".fullScreenPlaceholder .explanationContainer").style.display="none"}function selectSourceRating(e){RATING_BUTTONS.forEach(e=>e.classList.remove("selectedRating")),e.classList.add("selectedRating")}function openSourceFilterMenu(){document.querySelector(".horizontalFilterMenu").style.display="flex",document.querySelector(".pageWrapper").style.opacity="0.1"}function closeSourceFilterMenu(){document.querySelector(".horizontalFilterMenu").style.display="none",document.querySelector(".pageWrapper").removeAttribute("style")}let isSourceBeingRated=!1;const RATING_BUTTONS=document.querySelectorAll(".sourceRatingsWrapper .ratingsContainer .ratingsButtonContainer button");document.querySelectorAll(".sourceRankingContainer .subscribeButton").forEach(e=>e.addEventListener("click",()=>changeSubscriptionStatusSR(e))),document.querySelectorAll(".filterSidebar form .websiteDropdown, .horizontalFilterMenu form .websiteDropdown").forEach(e=>e.addEventListener("click",t=>createDropdown("website",e,t.target))),document.querySelectorAll(".filterSidebar form .sectorDropdown, .horizontalFilterMenu form .sectorDropdown").forEach(e=>e.addEventListener("click",t=>createDropdown("sector",e,t.target))),document.querySelectorAll(".filterSidebar form .tagDropdown, .horizontalFilterMenu form .tagDropdown").forEach(e=>e.addEventListener("click",t=>createDropdown("tag",e,t.target))),document.querySelectorAll("form .selectContainer .dropdown li").forEach(e=>e.addEventListener("click",e=>selectDropdown(e.target))),document.querySelectorAll("form .choiceContainer").forEach(e=>e.addEventListener("click",e=>{e.target.querySelector("input")&&(e.target.querySelector("input").checked?e.target.querySelector("input").checked=!1:e.target.querySelector("input").checked=!0)})),document.querySelectorAll(".sourceAddToListButton").forEach(e=>e.addEventListener("click",e=>openAddSourceToListsFormSR(e.target))),document.querySelector(".openFiltersButton").addEventListener("click",()=>openSourceFilterMenu()),document.querySelector(".horizontalFilterMenu .discardButton").addEventListener("click",()=>closeSourceFilterMenu()),document.querySelectorAll(".sourceRankingContainer .infoContainer .rateSpan").forEach(e=>{e.classList.contains("openAuthPrompt")||e.addEventListener("click",e=>openSourceRatingMenu(e.target))}),document.querySelector(".sourceRatingsWrapper .ratingsContainer .header .fa-times").addEventListener("click",()=>closeSourceRatingMenu()),RATING_BUTTONS.forEach(e=>e.addEventListener("click",()=>selectSourceRating(e))),document.querySelector(".sourceRatingsWrapper .ratingsContainer .rateSourceButton").addEventListener("click",()=>rateSourceSR()),document.querySelector(".filterSidebar .selectContainer .infoLink i").addEventListener("click",()=>openTopSourceExplanation());