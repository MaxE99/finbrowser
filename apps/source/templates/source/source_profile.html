{% extends 'home/base.html' %} {% load static %} {% load tags %} {% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'source/min_source_profile_style_v3.css' %}" />
<title>{{ source.name }} Profile | FinBrowser</title>
<meta name="description" content="Discover the latest content from {{ source.name }}">
{% endblock %} {% block content %}

<div class="upperContainer">
  <div class="leftInnerContainer">
    <div class="listPictureContainer">
      <img class="profilePicture" src="{% static source.favicon_path %}" alt="Source Picture" />
    </div>
  </div>
  <div class="rightInnerContainer">
    <div class="upperInnerContainer">
      <div class="sourceNameAndWebsiteContainer">
        <h3 class="sourceName" id="sid#{{ source.source_id }}">{{ source.name }}</h3>
        <div class="sourceContainer">
          <div class="iconContainer">
            <img class="sourcePic" src="{% static source.website.logo %}" alt="Website Logo" />
          </div>
          <a class="sourceLink" href="{{ source.url }}" target="_blank"
            aria-label="Open External Profile Of {{ source.name }}"></a>
        </div>
      </div>
      <div class="sectorContainer sectorContainerSmartphonePositioning">Sector:
        <a href="{{ source.sector.get_absolute_url }}"
          aria-label="Open Sector - {{ source.sector.name }}">{{ source.sector.name }}</a>
      </div>
      <div class="notificationAndSubscribtionContainer">
        {% if request.user.is_authenticated %}
        {% if notifications_activated %}
        <i role="button" aria-label="Activate Notifications" class="fas fa-bell notificationActivated"></i>
        {% else %}
        <i role="button" aria-label="Deactivate Notifications" class="fas fa-bell"></i>
        {% endif %}
        <button aria-label="Add Source To Lists" class="addSourceToListButton"><i class="fas fa-list"></i></button>
        <div role="form" class="addToListForm addSourceToListForm">
          <div class="formHeaderContainer">Add To Lists<i class="fas fa-times closeFormContainerButton"></i>
          </div>
          {% if user_lists %}
          <div class="listSelectionContainer">
            {% for list in user_lists %}
            <div class="listContainer">
              <label for="id_list_{{ list.list_id }}">
                {% if source in list.sources.all %}
                <input id="id_list_{{ list.list_id }}" class="sourceInList" type="checkbox" name="lists"
                  value="{{ list.list_id }}" checked="True"> {{ list }}
                {% else %}
                <input id="id_list_{{ list.list_id }}" class="sourceNotInList" type="checkbox" name="lists"
                  value="{{ list.list_id }}">
                {{ list }}
                {% endif %}
              </label>
            </div>
            {% endfor %}
          </div>
          <div class="buttonsContainer">
            <button class="saveButton">Save</button>
            <button class="createNewListButton">Create</button>
          </div>
          {% else %}
          <div class="listContainer">You haven't created any lists!</div>
          <button class="createNewListButton createFirstList">Create First List</button>
          {% endif %}
        </div>
        <div class="createListMenu sourcesCreateListMenu formContainer">
          <div class="formHeaderContainer">Create A New List<i class="fas fa-times closeFormContainerButton"></i>
          </div>
          <form enctype="multipart/form-data" method="POST" class="createListForm">
            {% csrf_token %} {{ add_list_form }}
            <input name="createListForm" type="submit" class="formSubmitButton" value="Save" />
          </form>
        </div>
        {% if subscribed %}
        <button class="subscribeButton subscribed">Subscribed</button>
        {% else %}
        <button class="subscribeButton unsubscribed">Subscribe</button>
        {% endif %}
        {% else %}
        <a href="{% url 'account_login' %}" class="subscribeButton unsubscribed registrationLink"
          aria-label="Login To Subscribe To Source">Subscribe</a>
        {% endif %}
      </div>
    </div>
    <div class="sectorContainer">Sector:
      <a href="{{ source.sector.get_absolute_url }}"
        aria-label="Open Sector - {{ source.sector.name }}">{{ source.sector.name }}</a>
    </div>
    <div class="ratingsWrapper">
      <div class="rankingsUpperContainer">
        <div class="rankingsHeader">Ratings</div>
        {% if request.user.is_authenticated %}
        <button type="button" class="rateListButton openRateListButton">Rate</button>
        {% else %}
        <a href="{% url 'account_login' %}" class="rateListButton registrationLink"
          aria-label="Login To Rate Source">Rate</a>
        {% endif %}
        <div class="rate-formUpperContainer">
          <h3>Rate {{ source.name }}</h3>
          <div role="form" aria-label="Rate Source" class="rate-form" action="" method="POST">
            <button aria-label="1 Star Rating" type="submit" class="fa fa-star rankingStar" id="first"></button>
            <button aria-label="2 Star Rating" type="submit" class="fa fa-star rankingStar" id="second"></button>
            <button aria-label="3 Star Rating" type="submit" class="fa fa-star rankingStar" id="third"></button>
            <button aria-label="4 Star Rating" type="submit" class="fa fa-star rankingStar" id="fourth"></button>
            <button aria-label="5 Star Rating" type="submit" class="fa fa-star rankingStar" id="fifth"></button>
          </div>
        </div>
      </div>
      <div class="rankingsContainer">
        <div class="rating">
          <div class="ratedContainer">
            <button aria-label="1 Star Rating" type="button" class="fa fa-star ratedStar" id="first"></button>
            <button aria-label="2 Star Rating" type="button" class="fa fa-star ratedStar" id="second"></button>
            <button aria-label="3 Star Rating" type="button" class="fa fa-star ratedStar" id="third"></button>
            <button aria-label="4 Star Rating" type="button" class="fa fa-star ratedStar" id="fourth"></button>
            <button aria-label="5 Star Rating" type="button" class="fa fa-star ratedStar" id="fifth"></button>
          </div>
          {% if average_rating != "None" %}
          <div class="avgRating"><span>{{ source.average_rating }}</span> out of 5</div>
          {% else %}
          <div class="avgRating">No Ratings</div>
          {% endif %}
        </div>
      </div>
      <div class="ratingsAmmountContainer">based on <span class="ratingsAmmount">
          {{ source.ammount_of_ratings }}</span> ratings</div>
    </div>
  </div>
</div>


{% if latest_articles %}
{% if links_and_retweets or images %}
<div class="contentColumnWrapper">
  {% if latest_articles %}
  <div class="contentColumnContainer {% if not links_and_retweets or not images %}halfPageContainer{% endif %}">
    {% create_content_container "Latest Tweets" latest_articles request user_lists csrf_token add_list_form highlighted_content_ids %}
    <div class="pagination">
      <span class="step-links">
        {% for i in latest_articles.paginator.page_range %}
        {% if latest_articles.number == i %}
        <button class="currentPagination">{{ latest_articles.number }}</button>
        {% elif i > latest_articles.number|add:'-3' and i < latest_articles.number|add:'3' %} <a
          href="?latest_content={{ i }}">{{ i }}</a>
        {% endif %}
        {% endfor %}
      </span>
    </div>
  </div>
  {% endif %}
  {% if links_and_retweets %}
  <div class="contentColumnContainer {% if not latest_articles or not images %}halfPageContainer{% endif %}">
    {% create_content_container "Links & Retweets" links_and_retweets request user_lists csrf_token add_list_form highlighted_content_ids %}
    <div class="pagination">
      <span class="step-links">
        {% for i in links_and_retweets.paginator.page_range %}
        {% if links_and_retweets.number == i %}
        <button class="currentPagination">{{ links_and_retweets.number }}</button>
        {% elif i > links_and_retweets.number|add:'-3' and i < links_and_retweets.number|add:'3' %} <a
          href="?links_and_retweets={{ i }}">{{ i }}</a>
        {% endif %}
        {% endfor %}
      </span>
    </div>
  </div>
  {% endif %}
  {% if images %}
  <div
    class="contentColumnContainer {% if not latest_articles or not links_and_retweets %}halfPageContainer{% endif %}">
    {% create_content_container "Graphics & Images" images request user_lists csrf_token add_list_form highlighted_content_ids %}
    <div class="pagination">
      <span class="step-links">
        {% for i in images.paginator.page_range %}
        {% if images.number == i %}
        <button class="currentPagination">{{ images.number }}</button>
        {% elif i > images.number|add:'-3' and i < images.number|add:'3' %} <a href="?images={{ i }}"
          aria-label="Change Page">{{ i }}</a>
        {% endif %}
        {% endfor %}
      </span>
    </div>
  </div>
  {% endif %}
</div>
{% else %}
<div class="contentColumnWrapper">
  <div class="contentColumnContainer halfPageContainer">
    {% create_content_container "Latest Content" latest_articles request user_lists csrf_token add_list_form highlighted_content_ids %}
    <div class="pagination">
      <span class="step-links">
        {% for i in latest_articles.paginator.page_range %}
        {% if latest_articles.number == i %}
        <button class="currentPagination">{{ latest_articles.number }}</button>
        {% elif i > latest_articles.number|add:'-3' and i < latest_articles.number|add:'3' %} <a
          href="?latest_content={{ i }}">{{ i }}</a>
        {% endif %}
        {% endfor %}
      </span>
    </div>
  </div>
</div>
{% endif %}
{% endif %}

{% if lists %}
{% create_list_slider_container "Lists" lists %}
{% endif %}

{{ user_rating|json_script:"user-rating" }}
<script src="{% static 'source/min_source_profile_script_v5.js' %}"></script>
{% endblock content %}