{% extends 'home/base.html' %}
{% load static %}
{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'accounts/min_settings_style_v7.css' %}">
<title>FinBrowser | Settings</title>
{% endblock %}

{% block content %}

<div class="settingSidebar" role="navigation" aria-label="Settings Menu">
    <div class="settingOption activeSettingOption" data-for-tab="0">Profile</div>
    <div class="settingOption" data-for-tab="1">Password</div>
    <div class="settingOption" data-for-tab="2">Notifications</div>
    <div class="settingOption" data-for-tab="3">Privacy</div>
</div>
<div class="contentSection">
    <div class="tabsContent tabsContentActive" data-tab="0">
        <form class="editSection changeProfileForm" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <h2>Account</h2>
            <div class="usernameAndEmailContainer">
                <div class="usernameContainer">
                    {{ email_and_name_change_form.username.label_tag }}
                    {{ email_and_name_change_form.username }}
                </div>
                <div class="emailContainer" id="upi#{{ user.profile.profile_id }}">
                    {{ email_and_name_change_form.email.label_tag }}
                    {{ email_and_name_change_form.email }}
                </div>
            </div>
            <div class="profilePicContainer">
                {{ profile_change_form.profile_pic.label_tag }}
                <div class="profilePicInnerContainer">
                    {% if user.profile.profile_pic %}
                    <img src="{{ user.profile.profile_pic.url }}" alt="Profile Picture">
                    {% else %}
                    <img src="{% static 'home/media/finbrowser-bigger-logo.png' %}" alt="Profile Picture Placeholder">
                    {% endif %}
                    <div class="changeProfilePicButton" role="button">
                        <span>Change</span>
                        {{ profile_change_form.profile_pic }}
                    </div>
                    <button type="button" class="removeProfilePicButton">Remove</button>
                </div>
            </div>
            <div class="buttonContainer">
                <button type="submit" href="{% url 'accounts:settings' %}" class="cancelButton">Cancel</button>
                <input class="saveButton" name="changeProfileForm" type="submit" value="Save">
            </div>
        </form>
    </div>
    <div class="tabsContent" data-tab="1">
        <h2>Change Password</h2>
        <form class="changePasswordForm" method="POST">
            {% csrf_token %} {{ change_password_form }}
            <input name="changePasswordForm" type="submit" class="passwordChangeSubmit" value="Save" />
        </form>
    </div>
    <div class="tabsContent" data-tab="2">
        {% if notifications %}
        <div class="sliderHeader">
            <div class="sliderHeaderTitle">Source Notifications</div>
        </div>
        <div class="notificationContainer">
            {% for notification in notifications %}
            {% if notification.source %}
            <div class="sourceContainer">
                <div class="iconContainer">
                    <i class="fas fa-times" id="soni#{{ notification.notification_id }}" role="button"
                        aria-label="Delete Notification"></i>
                    <img class="sourcePic" src="{% static notification.source.favicon_path %}" alt="Source Picture">
                </div>
                <a aria-label="Open Profile Of {{ notification.source.name }}" class="sourceLink"
                    href="{{ notification.source.get_absolute_url }}"></a>
                <div class="sourceNameOuterContainer">
                    <div class="sourceNameInnerContainer">{{ notification.source.name }}</div>
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="sliderHeader">
            <div class="sliderHeaderTitle">Stock Notifications</div>
        </div>
        <div class="notificationContainer">
            {% for notification in notifications %}
            {% if notification.stock %}
            <div class="keywordContainer">
                <i class="fas fa-check"></i>
                {{ notification.stock.ticker }}
                <i class="fas fa-times" id="stni#{{ notification.notification_id }}" role="button"
                    aria-label="Delete Notification">
                </i>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="sliderHeader">
            <div class="sliderHeaderTitle">Keyword Notifications</div>
        </div>
        <div class="notificationContainer">
            {% for notification in notifications %}
            {% if notification.keyword %}
            <div class="keywordContainer">
                <i class="fas fa-check"></i>
                {{ notification.keyword }}
                <i class="fas fa-times" id="kni#{{ notification.notification_id }}" role="button"
                    aria-label="Delete Notification">
                </i>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        {% else %}
        <div class="noNotificationsActivated">You haven't activated any notifications!</div>
        {% endif %}
    </div>
    <div class="tabsContent" data-tab="3">
        <h2>Change Privacy Settings</h2>
        <form class="changePrivacySettingsForm" method="POST">
            {% csrf_token %}
            {% for field in privacy_settings_form %}
            <div class="privacySettingsContainer">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                <input id="{{ field.id_for_label }}" type="checkbox" name="{{ field.name }}" {% if field.value %}
                    checked {% endif %}>
            </div>
            {% endfor %}
            <input name="changePrivacySettingsForm" type="submit" class="privacySettingsChangeSubmit" value="Save" />
        </form>
    </div>
</div>

<script src="{% static 'accounts/min_settings_script_v6.js' %}"></script>
{% endblock content %}