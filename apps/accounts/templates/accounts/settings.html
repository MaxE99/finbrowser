{% extends 'home/base.html' %}
{% load static %}
{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'accounts/min_settings_style_v5.css' %}">
<title>FinBrowser | Settings</title>
{% endblock %}

{% block content %}

<div class="settingSidebar" role="navigation" aria-label="Settings Menu">
    <div class="settingOption activeSettingOption" data-for-tab="0">Profile</div>
    <div class="settingOption" data-for-tab="1">Password</div>
    <div class="settingOption" data-for-tab="2">Notifications</div>
    <div class="settingOption" data-for-tab="3">Privacy</div>
</div>
<div class="contentSection">
    <div class="tabsContent tabsContentActive" data-tab="0">
        <form class="editSection changeProfileForm" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <h2>Account</h2>
            <div class="usernameAndEmailContainer">
                <div class="usernameContainer">
                    {{ email_and_name_change_form.username.label_tag }}
                    {{ email_and_name_change_form.username }}
                </div>
                <div class="emailContainer" id="upi#{{ user.profile.profile_id }}">
                    {{ email_and_name_change_form.email.label_tag }}
                    {{ email_and_name_change_form.email }}
                </div>
            </div>
            <div class="profilePicContainer">
                {{ profile_change_form.profile_pic.label_tag }}
                <div class="profilePicInnerContainer">
                    {% if user.profile.profile_pic %}
                    <img src="{{ user.profile.profile_pic.url }}" alt="Profile Picture">
                    {% else %}
                    <img src="{% static 'home/media/finbrowser-bigger-logo.png' %}" alt="Profile Picture Placeholder">
                    {% endif %}
                    <div class="changeProfilePicButton" role="button">
                        <span>Change</span>
                        {{ profile_change_form.profile_pic }}
                    </div>
                    <button type="button" class="removeProfilePicButton">Remove</button>
                </div>
            </div>
            <label>Social Links:</label>
            {% for social in social_links %}
            <div class="existingSocialContainer">
                <img class="{{ social.website.name }}" src="{% static social.website.logo %}"
                    id="ewi#{{ social.website.website_id }}" alt="Website Logo">
                <input type="text" value="{{ social.url }}">
                <button type="button" class="removeSocialLinkButton"
                    id="sli#{{ social.social_link_id }}">Remove</button>
                <button type="button" class="saveSocialLinkChanges">Save</button>
            </div>
            {% endfor %}
            <div class="socialLinksWrapper">
                <div class="addSocialLinksContainer">
                    <div class="selectContainer" role="button" aria-label="Select Social Link Website">
                        <details>
                            <summary><i class="fa fa-caret-down"></i></summary>
                            <ul>
                                {% for website in websites %}
                                <li><img class="{{ website.name }}" src="{% static website.favicon %}"
                                        alt="Website Logo" id="wi#{{ website.website_id }}"></li>
                                {% endfor %}
                            </ul>
                        </details>
                    </div>
                    <input placeholder="Enter the url of your account" class="linkInput" type="text">
                </div>
                <button type="button" name="changeProfileForm" class="addSocialLinkButton">Add</button>
            </div>
            <div class="buttonContainer">
                <button type="submit" href="{% url 'accounts:settings' %}" class="cancelButton">Cancel</button>
                <input class="saveButton" name="changeProfileForm" type="submit" value="Save">
            </div>
        </form>
    </div>
    <div class="tabsContent" data-tab="1">
        <h2>Change Password</h2>
        <form class="changePasswordForm" method="POST">
            {% csrf_token %} {{ change_password_form }}
            <input name="changePasswordForm" type="submit" class="passwordChangeSubmit" value="Save" />
        </form>
    </div>
    <div class="tabsContent" data-tab="2">
        {% if notifications %}
        <div class="sliderHeader">
            <div class="sliderHeaderTitle">Source Notifications</div>
        </div>
        <div class="notificationContainer">
            {% for notification in notifications %}
            {% if notification.source %}
            <div class="sourceContainer">
                <div class="iconContainer">
                    <i class="fas fa-trash" id="soni#{{ notification.notification_id }}" role="button"
                        aria-label="Delete Notification"></i>
                    <img class="sourcePic" src="{% static notification.source.favicon_path %}" alt="Source Picture">
                </div>
                <a aria-label="Open Profile Of {{ notification.source.name }}" class="sourceLink"
                    href="{{ notification.source.get_absolute_url }}"></a>
                <div class="sourceNameOuterContainer">
                    <div class="sourceNameInnerContainer">{{ notification.source.name }}</div>
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="sliderHeader">
            <div class="sliderHeaderTitle">Stock Notifications</div>
        </div>
        <div class="notificationContainer">
            {% for notification in notifications %}
            {% if notification.stock %}
            <div class="keywordContainer">
                <div class="iconContainer">
                    <i class="fas fa-trash" id="stni#{{ notification.notification_id }}" role="button"
                        aria-label="Delete Notification">
                    </i>
                </div>
                {{ notification.stock.ticker }}
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="sliderHeader">
            <div class="sliderHeaderTitle">Keyword Notifications</div>
        </div>
        <div class="notificationContainer">
            {% for notification in notifications %}
            {% if notification.keyword %}
            <div class="keywordContainer">
                <div class="iconContainer">
                    <i class="fas fa-trash" id="kni#{{ notification.notification_id }}" role="button"
                        aria-label="Delete Notification">
                    </i>
                </div>
                {{ notification.keyword }}
            </div>
            {% endif %}
            {% endfor %}
        </div>
        {% else %}
        <div class="noNotificationsActivated">You haven't activated any notifications!</div>
        {% endif %}
    </div>
    <div class="tabsContent" data-tab="3">
        <h2>Change Privacy Settings</h2>
        <form class="changePrivacySettingsForm" method="POST">
            {% csrf_token %}
            {% for field in privacy_settings_form %}
            <div class="privacySettingsContainer">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                <input id="{{ field.id_for_label }}" type="checkbox" name="{{ field.name }}" {% if field.value %}
                    checked {% endif %}>
            </div>
            {% endfor %}
            <input name="changePrivacySettingsForm" type="submit" class="privacySettingsChangeSubmit" value="Save" />
        </form>
    </div>
</div>

<script src="{% static 'accounts/min_settings_script_v4.js' %}"></script>
{% endblock content %}