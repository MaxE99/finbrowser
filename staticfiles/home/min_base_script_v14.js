function getCookie(e){let t=null;if(document.cookie&&""!==document.cookie){let i=document.cookie.split(";");for(let r=0;r<i.length;r++){let n=i[r].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}}return t}function get_fetch_settings(e){let t={method:e,headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin"};return t}function showMessage(e,t){document.querySelectorAll(".messages").forEach(e=>{e.remove()});let i=document.createElement("ul");i.classList.add("messages");let r=document.createElement("li");r.innerText=e,"Success"==t?r.classList.add("success"):"Remove"==t?r.classList.add("remove"):r.classList.add("error"),i.appendChild(r),document.querySelector(".overlay").appendChild(i)}document.querySelector(".headerContainer .fa-bars").addEventListener("click",()=>{let e=document.querySelector(".horizontalNavigation");"ON"==e.value?(e.style.maxHeight="0",e.value="OFF"):(e.style.maxHeight="100rem",e.value="ON")}),document.querySelectorAll("input").forEach(e=>{e.setAttribute("autocomplete","off")}),document.querySelector(".headerContainer #mainAutocomplete").addEventListener("click",()=>{if(check_device_width_below(500)&&!document.querySelector(".headerContainer .mainSearchWrapper .closeSearchIcon")){document.querySelector(".headerContainer .logoContainer").style.display="none",document.querySelector(".headerContainer .fa-bars").style.display="none",document.querySelector(".headerContainer .mainSearchWrapper").style.width="100%",document.querySelector(".headerContainer .mainSearchContainer").style.display="flex",document.querySelector(".headerContainer .mainSearchContainer").style.justifyContent="center",document.querySelector(".headerContainer .mainSearchContainer").style.position="relative",document.querySelector(".headerContainer .mainSearchContainer").style.width="90%",document.querySelector(".headerContainer #mainAutocomplete").style.width="97.5%",document.querySelector(".headerContainer #mainAutocomplete").style.maxWidth="unset";let e=document.createElement("i");e.classList.add("fas","fa-times","closeSearchIcon"),document.querySelector(".headerContainer .mainSearchWrapper").appendChild(e),e.addEventListener("click",()=>{document.querySelector(".headerContainer .mainSearchWrapper .closeSearchIcon").remove(),document.querySelector(".headerContainer .logoContainer").style.display="",document.querySelector(".headerContainer .fa-bars").style.display="",document.querySelector(".headerContainer .mainSearchWrapper").style.width="",document.querySelector(".headerContainer .mainSearchContainer").style.display="",document.querySelector(".headerContainer .mainSearchContainer").style.justifyContent="",document.querySelector(".headerContainer .mainSearchContainer").style.position="",document.querySelector(".headerContainer .mainSearchContainer").style.width="",document.querySelector(".headerContainer #mainAutocomplete").style.width="",document.querySelector(".headerContainer #mainAutocomplete").style.maxWidth=""})}}),document.getElementById("mainAutocomplete").addEventListener("keyup",async function(e){let t=document.getElementById("mainAutocomplete").value;if("Enter"==e.key&&""!=t.replaceAll(/\s/g,""))window.location.href=`../../../../../../search_results/${t}`;else{let i=document.getElementById("mainAutocomplete_result");if(t&&""!=t.replaceAll(/\s/g,"")){try{let r=await fetch(`../../../../../../api/search_site/${t}`,get_fetch_settings("GET"));if(r.ok){document.querySelector(".mainInputSearch").style.borderRadius="0.8rem 0.8rem 0 0";let n=await r.json();if(i.style.display="flex",i.innerHTML="",n[0].length>0&&(i.innerHTML+='<div class="searchResultHeader">Stocks</div>',n[0].forEach(e=>{let t=`<div class="searchResult"><div class="stockContainer"><div class="stockTicker">${e.ticker}</div><div class="companyName">${e.full_company_name}</div><a href="../../../../../../stock/${e.ticker}"></a></div></div>`;i.innerHTML+=t})),n[1].length>0&&(i.innerHTML+='<div class="searchResultHeader">Sources</div>',n[1].forEach(e=>{let t=`<div class="searchResult"><img src="https://finbrowser.s3.us-east-2.amazonaws.com/static/${e.favicon_path}"><span>${e.name}</span><a href="../../../../../../source/${e.slug}"></a></div>`;i.innerHTML+=t})),n[2].length>0){i.innerHTML+='<div class="searchResultHeader">Articles</div>';for(let a=0,s=n[2].length;a<s;a++){let l=n[3][a],o=n[2][a].title,c=n[2][a].link,d=`<div class="searchResult"><img src="https://finbrowser.s3.us-east-2.amazonaws.com/static/${l}"><span>${o}</span><a href="${c}" target="_blank"></a></div>`;i.innerHTML+=d}}}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(u){}document.onclick=function(e){"autocomplete_list_results"!==e.target.id&&(i.style.display="none",document.querySelector(".mainInputSearch").style.borderRadius="0.8rem")}}else i.style.display="none",document.querySelector(".mainInputSearch").style.borderRadius="0.8rem"}}),document.querySelector(".mainSearchContainer i").addEventListener("click",()=>{""!=(search_term=document.querySelector(".mainInputSearch").value).replaceAll(/\s/g,"")&&(window.location.href=`../../../../../../search_results/${search_term}`)});const dropdownButton=document.querySelector(".fa-sort-down");function checkForOpenContainers(){let e=!0,t=document.querySelectorAll(".addToListForm");for(let i=0,r=t.length;i<r;i++)if("none"!=t[i].style.display&&t[i].style.display){e=!1;break}return e}dropdownButton&&dropdownButton.addEventListener("click",()=>{let e=document.querySelector(".profileMenu");"flex"==e.style.display?e.style.display="none":e.style.display="flex"});let previousOptionsContainer,previousEllipsis;function get_initial_list_statuses(e){let t=[],i=[],r=e.parentElement.nextElementSibling.querySelectorAll(".listContainer input");for(let n=0,a=r.length;n<a;n++)t.push(r[n].checked),i.push(r[n].id.split("#")[1]);return[t,i]}function check_new_list_status(e){let t=[];return e.parentElement.previousElementSibling.querySelectorAll("input").forEach(e=>{t.push(e.checked)}),t}async function add_article_to_list(e,t){try{let i=await fetch(`../../../../../../api/lists/${e}/add_article_to_list/${t}/`,get_fetch_settings("POST"));i.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(r){}}async function remove_article_from_list(e,t){try{let i=await fetch(`../../../../../../api/lists/${e}/delete_article_from_list/${t}/`,get_fetch_settings("DELETE"));i.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(r){}}function check_device_width_below(e){let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;return t<e}document.querySelectorAll(".fa-ellipsis-h").forEach(e=>{e.addEventListener("click",function(t){let i=checkForOpenContainers();if(i){previousOptionsContainer&&t.target!==previousEllipsis&&(previousOptionsContainer.style.display="none");let r=e.parentElement.querySelector(".articleOptionsContainer");"flex"!=r.style.display?(r.style.display="flex",document.onclick=function(t){t.target!==e&&(e.parentElement.querySelector(".articleOptionsContainer").style.display="none")}):r.style.display="none",previousOptionsContainer=e.parentElement.querySelector(".articleOptionsContainer"),previousEllipsis=e}})}),document.querySelectorAll(".addToHighlightedButton").forEach(e=>{e.addEventListener("click",async()=>{if(!e.classList.contains("registrationLink")){let t=e.closest(".articleContainer").id.split("#")[1],i=e.lastElementChild.innerText,r;r="Highlight article"==i?"highlight":"unhighlight";try{let n={article_id:t},a=await fetch("../../../../../../api/highlighted_articles/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(n)});if(a.ok){let s=await a.json();"highlight"==r?(showMessage(s,"Success"),e.innerHTML='<i class="fas fa-times"></i><span>Unhighlight article</span>'):(showMessage(s,"Remove"),e.innerHTML='<i class="fas fa-highlighter"></i><span>Highlight article</span>')}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(l){}}})}),document.querySelectorAll(".addToListButton").forEach(e=>{e.addEventListener("click",()=>{if(!e.classList.contains("registrationLink")){let t=checkForOpenContainers();t&&(e.parentElement.nextElementSibling.style.display="block");let i=get_initial_list_statuses(e),r=i[0],n=e.parentElement.parentElement.querySelector(".addToListForm");if(n.querySelector(".saveButton")){let a=n.querySelector(".saveButton");a.addEventListener("click",()=>{let e=i[1],t=a.closest(".articleContainer").id.split("#")[1],s=check_new_list_status(a);for(let l=0,o=s.length;l<o;l++)s[l]!=r[l]&&(!1==r[l]?add_article_to_list(e[l],t):remove_article_from_list(e[l],t));showMessage("Lists have been updated!","Success"),n.style.display="none"})}}})}),document.querySelectorAll(".addToListForm .fa-times").forEach(e=>{e.addEventListener("click",()=>{e.parentElement.parentElement.style.display="none"})}),document.querySelectorAll(".createNewListButton").forEach(e=>{e.addEventListener("click",()=>{e.classList.contains("registrationLink")||(e.parentElement.parentElement.parentElement.querySelector(".addToListForm").style.display="none",check_device_width_below(500)?document.querySelector(".smartphoneCreateListMenu").style.display="flex":e.parentElement.parentElement.parentElement.querySelector(".createListMenu").style.display="flex")})}),document.querySelectorAll(".createListMenu .closeFormContainerButton").forEach(e=>{e.addEventListener("click",()=>{document.querySelectorAll(".createListMenu").forEach(e=>{e.style.display="none"})})}),document.querySelector(".userSpace .notificationBell")&&document.querySelector(".userSpace .notificationBell").addEventListener("click",async()=>{let e=document.querySelector(".userSpace .notificationContainer");if("block"==e.style.display)e.style.display="none",document.querySelector(".unseenNotifications").remove(),document.querySelectorAll(".unseenNotification").forEach(e=>{e.classList.remove("unseenNotification")});else{e.style.display="block";try{let t=await fetch("../../../../../../api/notifications/",get_fetch_settings("PUT"));t.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(i){}}});const notificationTabs=document.querySelectorAll(".notificationHeadersContainer div"),notificationContent=document.querySelectorAll(".notificationsContainer");notificationTabs.forEach(e=>{e.addEventListener("click",()=>{for(let t=0,i=notificationTabs.length;t<i;t++)notificationTabs[t].classList.remove("activeNotificationCategory"),notificationContent[t].classList.remove("activeNotificationContainer");notificationTabs[e.dataset.forTab].classList.add("activeNotificationCategory"),notificationContent[e.dataset.forTab].classList.add("activeNotificationContainer")})}),document.querySelectorAll(".handle").forEach(e=>{e.addEventListener("click",t=>{let i=t.target.closest(".sliderWrapper").querySelector(".slider"),r=parseInt(getComputedStyle(i).getPropertyValue("--slider-index")),n=parseInt(getComputedStyle(i).getPropertyValue("--items-per-screen")),a=Math.ceil(i.querySelectorAll(".contentWrapper").length/n);e.classList.contains("leftHandle")&&(r-1<0?i.style.setProperty("--slider-index",a-1):i.style.setProperty("--slider-index",r-1)),e.classList.contains("rightHandle")&&(r+1>=a?i.style.setProperty("--slider-index",0):i.style.setProperty("--slider-index",r+1))})}),document.querySelectorAll(".sliderWrapper .slider .subscribeButton").forEach(e=>{e.addEventListener("click",async()=>{try{let t=e.closest(".contentWrapper").id.split("#")[1],i=e.innerText,r=await fetch(`../../api/sources/${t}/source_change_subscribtion_status/`,get_fetch_settings("POST"));if(r.ok){let n=await r.json();"Subscribe"==i?(e.classList.add("subscribed"),e.innerText="Subscribed",showMessage(n,"Success")):(e.classList.remove("subscribed"),e.innerText="Subscribe",showMessage(n,"Remove"))}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(a){}})}),document.querySelectorAll(".sliderWrapper .slider .notificationButton").forEach(e=>{e&&e.addEventListener("click",async()=>{try{let t=e.closest(".contentWrapper").id.split("#")[1],i={source_id:t},r=await fetch("../../api/notifications/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(i)});if(r.ok){let n=await r.json();e.classList.contains("notificationActivated")?(e.classList.remove("notificationActivated"),e.innerText="Notification On",showMessage(n,"Remove")):(e.classList.add("notificationActivated"),e.innerText="Notification Off",showMessage(n,"Success"))}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(a){}})});