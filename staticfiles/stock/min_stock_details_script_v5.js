if(location.href.includes("?commentary=")){let t=document.querySelectorAll(".pageWrapper .tabsContainer button"),e=document.querySelectorAll(".pageWrapper .tabsContent");for(let o=0,i=t.length;o<i;o++)t[o].classList.remove("activatedTab"),e[o].classList.remove("tabsContentActive");t[1].classList.add("activatedTab"),e[1].classList.add("tabsContentActive")}if(location.href.includes("?news=")){let n=document.querySelectorAll(".pageWrapper .tabsContainer button"),r=document.querySelectorAll(".pageWrapper .tabsContent");for(let a=0,c=n.length;a<c;a++)n[a].classList.remove("activatedTab"),r[a].classList.remove("tabsContentActive");n[2].classList.add("activatedTab"),r[2].classList.add("tabsContentActive")}const notificationButton=document.querySelector(".stockActionContainer .notificationButton");function get_initial_portfolio_statuses(){let t=[],e=[],o=document.querySelectorAll(".stockMenuWrapper .addStockContainer .portfolioSelectionContainer input");for(let i=0,n=o.length;i<n;i++)t.push(o[i].checked),e.push(o[i].id.replace("portfolio_",""));return[t,e]}function check_new_portfolio_status(){let t=[],e=document.querySelectorAll(".stockMenuWrapper .addStockContainer .portfolioSelectionContainer input");return e.forEach(e=>{t.push(e.checked)}),t}async function add_stock_to_portfolio(t,e){for(let o=0;o<t.length;o++)try{let i={stock_id:e,portfolios:t[o]},n=await fetch("../../api/portfolio_stocks/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(i)});n.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(r){}}async function remove_stock_from_portfolio(t,e){for(let o=0;o<t.length;o++)try{let i=await fetch(`../../api/portfolio_stocks/remove_stock_from_portfolio/${t[o]}/${e}`,get_fetch_settings("DELETE"));i.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(n){}}notificationButton?.addEventListener("click",async()=>{if(!notificationButton.classList.contains("openAuthPrompt")){if(notificationButton.classList.contains("fa-bell"))try{let t=document.querySelector(".companyNameAndNotificationHeader .stockHeader").id.split("#")[1],e={stock:t},o=await fetch("../../api/notifications/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(e)});if(o.ok){let i=await o.json();notificationButton.id="nid#"+i.notification_id,notificationButton.classList.add("notificationActivated"),notificationButton.classList.replace("fa-bell","fa-bell-slash"),showMessage("Notification has been created!","Success")}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(n){}else{let r=notificationButton.id.split("#")[1];try{let a=await fetch(`../../api/notifications/${r}/`,get_fetch_settings("DELETE"));a.ok?(notificationButton.classList.remove("notificationActivated"),notificationButton.classList.replace("fa-bell-slash","fa-bell"),showMessage(context="Notification has been removed!","Remove")):showMessage("Error: Network request failed unexpectedly!","Error")}catch(c){}}}}),document.querySelector(".pageWrapper .stockActionContainer .fa-ellipsis-h").addEventListener("click",t=>{if(!t.target.classList.contains("openAuthPrompt")){setModalStyle(),document.querySelector(".stockMenuWrapper").style.display="flex",document.querySelector(".stockMenuWrapper .addStockContainer").style.display="block";let e=get_initial_portfolio_statuses(),o=e[0];document.querySelector(".stockMenuWrapper .addStockContainer .saveButton").addEventListener("click",()=>{let t=e[1],i=document.querySelector(".companyNameAndNotificationHeader .stockHeader").id.replace("sti#",""),n=[],r=[],a=check_new_portfolio_status();for(let c=0,s=a.length;c<s;c++)a[c]!=o[c]&&(!1==o[c]?n.push(t[c].replace("id_","")):r.push(t[c].replace("id_","")));n.length&&add_stock_to_portfolio(n,i),r.length&&remove_stock_from_portfolio(r,i),showMessage("Portfolios have been updated!","Success"),window.location.reload()},{once:!0})}}),document.querySelector(".stockMenuWrapper .addStockContainer .formHeaderContainer .fa-times").addEventListener("click",()=>{document.querySelector(".stockMenuWrapper").style.display="none",document.querySelector(".stockMenuWrapper .addStockContainer").style.display="none",removeModalStyle()}),document.querySelector(".stockMenuWrapper .addStockContainer .cancelButton").addEventListener("click",()=>{document.querySelector(".stockMenuWrapper").style.display="none",document.querySelector(".stockMenuWrapper .addStockContainer").style.display="none",removeModalStyle()}),document.querySelectorAll(".stockMenuWrapper .portfolioSelectionContainer .portfolioContainer").forEach(t=>t.addEventListener("click",()=>{t.querySelector("input:first-of-type").checked=!t.querySelector("input:first-of-type").checked}));