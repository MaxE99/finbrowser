async function createStockNotification(){try{let e=await fetch("../../api/notifications/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify({stock:STOCK_ID})});if(e.ok){let t=await e.json();NOTIFICATION_BUTTON.id="nid#"+t.notification_id,NOTIFICATION_BUTTON.classList.add("notificationActivated"),NOTIFICATION_BUTTON.classList.replace("fa-bell","fa-bell-slash"),showMessage("Notification has been created!","Success")}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}async function deleteStockNotification(){let e=NOTIFICATION_BUTTON.id.split("#")[1];try{let t=await fetch(`../../api/notifications/${e}/`,getFetchSettings("DELETE"));t.ok?(NOTIFICATION_BUTTON.classList.remove("notificationActivated"),NOTIFICATION_BUTTON.classList.replace("fa-bell-slash","fa-bell"),showMessage("Notification has been removed!","Remove")):showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}async function addStockToPortfolios(e){for(let t=0;t<e.length;t++)try{let o={stock_id:STOCK_ID,portfolios:e[t]},r=await fetch("../../api/portfolio_stocks/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(o)});r.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(c){showMessage("Error: Unexpected error has occurred!","Error")}}async function removeStockFromPortfolios(e){for(let t=0;t<e.length;t++)try{let o=await fetch(`../../api/portfolio_stocks/remove_stock_from_portfolio/${e[t]}/${STOCK_ID}`,getFetchSettings("DELETE"));o.ok||showMessage("Error: Network request failed unexpectedly!","Error")}catch(r){showMessage("Error: Unexpected error has occurred!","Error")}}function checkInitialStockInPortfoliosStatus(){let e=[],t=[];return document.querySelectorAll(".stockMenuWrapper .addStockContainer .portfolioSelectionContainer input").forEach(o=>{o.classList.contains("portfolioInList")?e.push(!0):e.push(!1),t.push(o.id.replace("id_portfolio_",""))}),[e,t]}function checkNewStockInPortfoliosStatus(){let e=[],t=document.querySelectorAll(".stockMenuWrapper .addStockContainer .portfolioSelectionContainer input");return t.forEach(t=>{e.push(t.checked)}),e}function saveStockPortfolioStatuses(){let[e,t]=checkInitialStockInPortfoliosStatus(),o=[],r=[],c=checkNewStockInPortfoliosStatus();for(let n=0;n<c.length;n++)c[n]!==e[n]&&(!1===e[n]?o.push(t[n]):r.push(t[n]));o.length&&addStockToPortfolios(o),r.length&&removeStockFromPortfolios(r),showMessage("Portfolios have been updated!","Success"),window.location.reload()}function changeStockNotificationStatus(){NOTIFICATION_BUTTON.classList.contains("openAuthPrompt")||(NOTIFICATION_BUTTON.classList.contains("fa-bell")?createStockNotification():deleteStockNotification())}function openAddStockToPortfoliosModal(e){e.classList.contains("openAuthPrompt")||(setModalStyle(),document.querySelector(".stockMenuWrapper").style.display="flex",document.querySelector(".stockMenuWrapper .addStockContainer").style.display="block",resetAddStockToListForm())}function closeAddStockToPortfoliosModal(){document.querySelector(".stockMenuWrapper").style.display="none",document.querySelector(".stockMenuWrapper .addStockContainer").style.display="none",removeModalStyle()}function resetAddStockToListForm(){document.querySelectorAll(".stockMenuWrapper .addStockContainer .portfolioContainer input").forEach(e=>{e.classList.contains("portfolioInList")?e.checked=!0:e.checked=!1})}function changeTabsOnPageOpen(e){let t=document.querySelectorAll(".pageWrapper .tabsContainer button"),o=document.querySelectorAll(".pageWrapper .tabsContent");for(let r=0,c=t.length;r<c;r++)t[r].classList.remove("activatedTab"),o[r].classList.remove("tabsContentActive");t[e].classList.add("activatedTab"),o[e].classList.add("tabsContentActive")}location.href.includes("?commentary=")&&changeTabsOnPageOpen(1),location.href.includes("?news=")&&changeTabsOnPageOpen(2);const NOTIFICATION_BUTTON=document.querySelector(".stockActionContainer .notificationButton"),STOCK_ID=document.querySelector(".companyNameAndNotificationHeader .stockHeader").id.split("#")[1];NOTIFICATION_BUTTON.addEventListener("click",()=>changeStockNotificationStatus()),document.querySelector(".pageWrapper .stockActionContainer .fa-ellipsis-h").addEventListener("click",e=>openAddStockToPortfoliosModal(e.target)),document.querySelector(".stockMenuWrapper .addStockContainer .cancelButton").addEventListener("click",()=>resetAddStockToListForm()),document.querySelector(".stockMenuWrapper .addStockContainer .formHeaderContainer .fa-times").addEventListener("click",()=>closeAddStockToPortfoliosModal()),document.querySelector(".stockMenuWrapper .addStockContainer .saveButton").addEventListener("click",()=>saveStockPortfolioStatuses(),{once:!0}),document.querySelectorAll(".stockMenuWrapper .portfolioSelectionContainer .portfolioContainer").forEach(e=>e.addEventListener("click",()=>{e.querySelector("input:first-of-type").checked=!e.querySelector("input:first-of-type").checked}));