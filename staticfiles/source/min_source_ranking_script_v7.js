document.querySelectorAll(".sourceRankingContainer .subscribeButton").forEach(e=>{e.addEventListener("click",async()=>{if(!e.classList.contains("openAuthPrompt"))try{let t=e.closest(".sourceRankingContainer").id.split("#")[1],r=e.innerText,n=await fetch(`../../api/sources/${t}/`,get_fetch_settings("PATCH"));n.ok?"Subscribe"==r?(e.classList.add("subscribed"),e.classList.replace("finButtonWhite","finButtonBlue"),e.innerText="Subscribed",showMessage(context="SOURCE HAS BEEN SUBSCRIBED!","Success")):(e.classList.remove("subscribed"),e.classList.replace("finButtonBlue","finButtonWhite"),e.innerText="Subscribe",showMessage(context="SOURCE HAS BEEN UNSUBSCRIBED!","Remove")):showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){}})});const websiteDropdown=document.querySelectorAll(".filterSidebar form .websiteDropdown, .horizontalFilterMenu form .websiteDropdown").forEach(e=>e.addEventListener("click",t=>{e.closest("form").querySelector(".sectorList").style.display="none",e.closest("form").querySelector(".tagList").style.display="none";let r=t.target.tagName.toUpperCase();"LI"!==r&&"INPUT"!==r&&("block"!==t.target.querySelector("ul").style.display?t.target.querySelector("ul").style.display="block":t.target.querySelector("ul").style.display="none",document.onclick=function(t){t.target.closest(".websiteList")||t.target===e||(e.querySelector("ul").style.display="none")})})),sectorDropdown=document.querySelectorAll(".filterSidebar form .sectorDropdown, .horizontalFilterMenu form .sectorDropdown").forEach(e=>e.addEventListener("click",t=>{e.closest("form").querySelector(".websiteList").style.display="none",e.closest("form").querySelector(".tagList").style.display="none";let r=t.target.tagName.toUpperCase();"LI"!==r&&"INPUT"!==r&&("block"!==t.target.querySelector("ul").style.display?t.target.querySelector("ul").style.display="block":t.target.querySelector("ul").style.display="none",document.onclick=function(t){t.target.closest(".sectorList")||t.target===e||(e.querySelector("ul").style.display="none")})})),tagDropdown=document.querySelectorAll(".filterSidebar form .tagDropdown, .horizontalFilterMenu form .tagDropdown").forEach(e=>e.addEventListener("click",t=>{e.closest("form").querySelector(".websiteList").style.display="none",e.closest("form").querySelector(".sectorList").style.display="none";let r=t.target.tagName.toUpperCase();"LI"!==r&&"INPUT"!==r&&("block"!==t.target.querySelector("ul").style.display?t.target.querySelector("ul").style.display="block":t.target.querySelector("ul").style.display="none",document.onclick=function(t){t.target.closest(".tagList")||t.target===e||(e.querySelector("ul").style.display="none")})}));document.querySelectorAll("form .selectContainer .dropdown li").forEach(e=>e.addEventListener("click",e=>{"INPUT"!==e.target.tagName.toUpperCase()&&(e.target.querySelector("input").checked?e.target.querySelector("input").checked=!1:e.target.querySelector("input").checked=!0)})),document.querySelectorAll("form .choiceContainer").forEach(e=>e.addEventListener("click",e=>{e.target.querySelector("input")&&(e.target.querySelector("input").checked?e.target.querySelector("input").checked=!1:e.target.querySelector("input").checked=!0)})),document.querySelectorAll(".sourceAddToListButton").forEach(e=>{e.addEventListener("click",e=>{if(setModalStyle(),!e.target.classList.contains("openAuthPrompt")){let t=e.target.closest(".sourceRankingContainer").id.split("#")[1],r=e.target.closest(".sourceRankingContainer").querySelector(".firstRow a span:last-of-type").innerText;document.querySelector(".fullScreenPlaceholder .addToListForm h2 span").innerText=r,document.querySelector(".fullScreenPlaceholder").style.display="flex",document.querySelector(".fullScreenPlaceholder .addSourceToListForm").style.display="block",document.querySelector(".fullScreenPlaceholder .addSourceToListForm").id="source_id"+t;let n=document.querySelectorAll(".fullScreenPlaceholder .listContainer input:first-of-type");n.forEach(e=>{let r=e.closest(".listContainer").querySelector(".sourcesInList").value;JSON.parse(r).includes(parseInt(t))?e.checked=!0:e.checked=!1}),document.querySelector(".fullScreenPlaceholder .addSourceToListForm .cancelButton")?.addEventListener("click",()=>{n.forEach(e=>{let r=e.closest(".listContainer").querySelector(".sourcesInList").value;JSON.parse(r).includes(parseInt(t))?e.checked=!0:e.checked=!1})})}})}),document.querySelector(".openFiltersButton").addEventListener("click",()=>{document.querySelector(".horizontalFilterMenu").style.display="flex",document.querySelector(".pageWrapper").style.opacity="0.1"}),document.querySelector(".horizontalFilterMenu .discardButton").addEventListener("click",()=>{document.querySelector(".horizontalFilterMenu").style.display="none",document.querySelector(".pageWrapper").removeAttribute("style")}),document.querySelectorAll(".sourceRankingContainer .infoContainer .rateSpan").forEach(e=>{e.classList.contains("openAuthPrompt")||e.addEventListener("click",e=>{let t=null;e.target.classList.contains("notRated")||document.querySelectorAll(".sourceRatingsContainer .ratingsButtonContainer button").forEach(r=>{r.innerText==e.target.innerText&&(r.classList.add("selectedRating"),t=e.target.innerText)}),document.querySelector(".sourceRatingsWrapper .ratingsContainer .cancelButton")?.addEventListener("click",()=>{document.querySelectorAll(".sourceRatingsContainer .ratingsButtonContainer button").forEach(e=>{e.classList.remove("selectedRating"),e.innerText==t&&e.classList.add("selectedRating")})});let r=e.target.closest(".sourceRankingContainer").querySelector(".firstRow a span:last-of-type").innerText,n=e.target.closest(".sourceRankingContainer").id.split("#")[1];document.querySelector(".sourceRatingsWrapper").id=n,document.querySelector(".sourceRatingsWrapper").style.display="flex",document.querySelector(".sourceRatingsWrapper .header h3").innerHTML=`Rate <span>${r}</span>`,setModalStyle()})}),document.querySelector(".sourceRatingsWrapper .ratingsContainer .header .fa-times").addEventListener("click",()=>{document.querySelector(".sourceRatingsContainer .ratingsButtonContainer .selectedRating")&&document.querySelector(".sourceRatingsContainer .ratingsButtonContainer .selectedRating").classList.remove("selectedRating"),document.querySelector(".sourceRatingsWrapper").style.display="none",removeModalStyle()});const ratingsButtons=document.querySelectorAll(".sourceRatingsWrapper .ratingsContainer .ratingsButtonContainer button");ratingsButtons.forEach(e=>e.addEventListener("click",()=>{ratingsButtons.forEach(e=>e.classList.remove("selectedRating")),e.classList.add("selectedRating")}));let activatedButton=!1;document.querySelector(".sourceRatingsWrapper .ratingsContainer .rateSourceButton").addEventListener("click",async()=>{let e=document.querySelector(".sourceRatingsWrapper").id,t=document.querySelector(".sourceRatingsWrapper .ratingsContainer .ratingsButtonContainer .selectedRating")?.innerText;if(body={source:e,rating:t},t&&!activatedButton){activatedButton=!0;try{let r=await fetch("../../api/source_ratings/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(body)});r.ok?(showMessage(context="Rating has been saved!","Success"),window.location.reload()):showMessage("Error: Network request failed unexpectedly!","Error")}catch(n){}}else t||activatedButton||showMessage("Select a rating!","Error")}),document.querySelector(".filterSidebar .selectContainer .infoLink i").addEventListener("click",()=>{setModalStyle(),document.querySelector(".fullScreenPlaceholder").style.display="flex",document.querySelector(".fullScreenPlaceholder .explanationContainer").style.display="block",document.querySelector(".fullScreenPlaceholder .explanationContainer h3").innerText="Top Sources",document.querySelector(".fullScreenPlaceholder .explanationContainer .explanation").innerText="I personally select Top Sources based on their outstanding analysis, insightful perspectives, and engaging content. These sources are my go-to for staying informed and entertained, and I highly recommend them.",document.querySelector(".fullScreenPlaceholder .fullScreenWrapper .explanationContainer .fa-times").addEventListener("click",()=>{removeModalStyle(),document.querySelector(".fullScreenPlaceholder").style.display="none",document.querySelector(".fullScreenPlaceholder .explanationContainer").style.display="none"})});
