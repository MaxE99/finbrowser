async function changeSubscriptionStatus(e){if(!e.classList.contains("openAuthPrompt"))try{let t=e.closest(".firstRow").querySelector("h2").id.split("#")[1],r=await fetch(`../../api/sources/${t}/`,getFetchSettings("PATCH"));r.ok?showSubscriptionStatus(e):showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}async function createNotification(){try{let e=NOITIFICATION_BUTTON.closest(".firstRow").querySelector("h2").id.split("#")[1],t=await fetch("../../api/notifications/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify({source:e})});if(t.ok){let r=await t.json();NOITIFICATION_BUTTON.id="nid#"+r.notification_id,NOITIFICATION_BUTTON.classList.add("notificationActivated"),NOITIFICATION_BUTTON.classList.replace("fa-bell","fa-bell-slash"),showMessage("Notification has been added!","Success")}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}async function deleteNotification(){let e=NOITIFICATION_BUTTON.id.split("#")[1];try{let t=await fetch(`../../api/notifications/${e}/`,getFetchSettings("DELETE"));t.ok?(NOITIFICATION_BUTTON.classList.remove("notificationActivated"),NOITIFICATION_BUTTON.classList.replace("fa-bell-slash","fa-bell"),showMessage("Notification has been removed!","Remove")):showMessage("Error: Network request failed unexpectedly!","Error")}catch(r){showMessage("Error: Unexpected error has occurred!","Error")}}async function rateSource(){let e=document.querySelector(".firstRow h2").id.split("#")[1],t=document.querySelector(".sourceRatingsWrapper .ratingsContainer .ratingsButtonContainer .selectedRating")?.innerText;if(t&&!isSourceBeingRated){isSourceBeingRated=!0;try{let r=await fetch("../../api/source_ratings/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify({source:e,rating:t})});r.ok?(showMessage("Rating has been saved!","Success"),window.location.reload()):showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){showMessage("Error: Unexpected error has occurred!","Error")}}else t||isSourceBeingRated||showMessage("Select a rating!","Error")}function openAddSourceToListsMenu(e){if(!e.classList.contains("openAuthPrompt")){setModalStyle();let t=document.querySelector(".pageWrapper .firstRow h2").id.split("#")[1],r=document.querySelector(".pageWrapper .firstRow h2").innerText;document.querySelector(".fullScreenPlaceholder .addToListForm h3 span").innerText=r,document.querySelector(".fullScreenPlaceholder").style.display="flex",document.querySelector(".fullScreenPlaceholder .addSourceToListForm").style.display="block",document.querySelector(".fullScreenPlaceholder .addSourceToListForm").id="source_id"+t,resetAddSourceToListsForm(t),document.querySelector(".fullScreenPlaceholder .addSourceToListForm .cancelButton")?.addEventListener("click",()=>resetAddSourceToListsForm(t))}}function openSourceRatingsMenu(){let e=document.querySelector(".pageWrapper .firstRow h2").innerText;document.querySelector(".sourceRatingsWrapper").style.display="flex",document.querySelector(".sourceRatingsWrapper .header h3").innerHTML=`Rate <span>${e}</span>`,setModalStyle(),document.querySelector(".sourceRatingsWrapper .ratingsContainer .cancelButton")?.addEventListener("click",()=>resetSourceRatingsMenu())}function closeSourceRatingsMenu(){document.querySelector(".sourceRatingsWrapper").style.display="none",removeModalStyle()}function resetSourceRatingsMenu(){document.querySelectorAll(".sourceRatingsContainer .ratingsButtonContainer button").forEach(e=>{e.classList.remove("selectedRating"),e.innerText==INITIAL_USER_RATING&&e.classList.add("selectedRating")})}function selectSourceRating(e){RATING_BUTTONS.forEach(e=>e.classList.remove("selectedRating")),e.classList.add("selectedRating")}const NOITIFICATION_BUTTON=document.querySelector(".firstRow .notificationButton"),RATING_BUTTONS=document.querySelectorAll(".sourceRatingsWrapper .ratingsContainer .ratingsButtonContainer button"),INITIAL_USER_RATING=document.querySelector(".sourceRatingsContainer .ratingsButtonContainer .selectedRating")?.innerText;let isSourceBeingRated=!1;document.querySelectorAll(".subscribeButton").forEach(e=>e.addEventListener("click",()=>changeSubscriptionStatus(e))),NOITIFICATION_BUTTON.classList.contains("openAuthPrompt")||NOITIFICATION_BUTTON.addEventListener("click",()=>NOITIFICATION_BUTTON.classList.contains("fa-bell")?createNotification():deleteNotification()),document.querySelectorAll(".rightSideContainer .ratingContainer .infoContainer .rateSpan").forEach(e=>!e.classList.contains("openAuthPrompt")&&e.addEventListener("click",()=>openSourceRatingsMenu())),document.querySelector(".sourceRatingsWrapper .ratingsContainer .header .fa-times").addEventListener("click",()=>closeSourceRatingsMenu()),RATING_BUTTONS.forEach(e=>e.addEventListener("click",()=>selectSourceRating(e))),document.querySelector(".sourceRatingsWrapper .ratingsContainer .rateSourceButton").addEventListener("click",()=>rateSource()),document.querySelector(".pageWrapper .firstRow .notificationAndSubscribtionContainer  .fa-ellipsis-h").addEventListener("click",e=>openAddSourceToListsMenu(e.target));