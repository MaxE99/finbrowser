const subscribeButton=document.querySelector(".subscribeButton");subscribeButton.addEventListener("click",async()=>{if(!subscribeButton.classList.contains("registrationLink"))try{let e=document.querySelector(".upperInnerContainer h3").id.split("#")[1],t=subscribeButton.innerText,r=await fetch(`../../api/sources/${e}/source_change_subscribtion_status/`,get_fetch_settings("POST"));if(r.ok){let i=await r.json();"SUBSCRIBE"==t?(subscribeButton.classList.replace("unsubscribed","subscribed"),subscribeButton.innerText="Subscribed",showMessage(i,"Success")):(subscribeButton.classList.replace("subscribed","unsubscribed"),subscribeButton.innerText="Subscribe",showMessage(i,"Remove"))}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){}});const one=document.getElementById("first"),two=document.getElementById("second"),three=document.getElementById("third"),four=document.getElementById("fourth"),five=document.getElementById("fifth"),confirmBox=document.getElementById("confirm-box"),handleStarSelect=(e,t)=>{let r=t.children;for(let i=0;i<r.length;i++)i<e?r[i].classList.add("checked"):r[i].classList.remove("checked")},handleSelect=e=>{let t=document.querySelector(".rate-form");switch(e){case"first":handleStarSelect(1,t);return;case"second":handleStarSelect(2,t);return;case"third":handleStarSelect(3,t);return;case"fourth":handleStarSelect(4,t);return;case"fifth":handleStarSelect(5,t);return;default:handleStarSelect(0,t)}},getNumericValue=e=>{let t;return"first"===e?1:"second"===e?2:"third"===e?3:"fourth"===e?4:"fifth"===e?5:0};if(one){let e=[one,two,three,four,five];e.forEach(e=>e.addEventListener("mouseover",e=>{handleSelect(e.target.id)}))}if(document.querySelectorAll(".rankingStar").forEach(e=>{e.addEventListener("click",async e=>{let t=e.target.id,r=getNumericValue(t),i=document.querySelector(".upperInnerContainer h3").id.split("#")[1];try{let o={source_id:i,rating:r},n=await fetch("../../api/source_ratings/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(o)});if(n.ok){let s=await n.json();showMessage(s,"Success"),window.location.reload()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(c){}})}),document.querySelector(".avgRating span")){let t=Math.round(document.querySelector(".avgRating span").innerText);handleStarSelect(t,document.querySelector(".ratedContainer"))}document.querySelector(".openRateListButton").addEventListener("click",()=>{document.querySelector(".rate-formUpperContainer").style.display="block",document.querySelector(".rating").style.opacity="0",document.querySelector(".ratingsAmmountContainer").style.opacity="0",document.querySelector(".rateListButton").style.opacity="0",document.querySelector(".rankingsHeader").style.opacity="0"});const notificationButton=document.querySelector(".notificationAndSubscribtionContainer .fa-bell");notificationButton&&notificationButton.addEventListener("click",async()=>{try{let e=document.querySelector(".upperInnerContainer h3").id.split("#")[1],t={source_id:e},r=await fetch("../../api/notifications/",{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),Accept:"application/json","Content-Type":"application/json"},mode:"same-origin",body:JSON.stringify(t)});if(r.ok){let i=await r.json();notificationButton.classList.contains("notificationActivated")?(notificationButton.classList.remove("notificationActivated"),showMessage(i,"Remove")):(notificationButton.classList.add("notificationActivated"),showMessage(i,"Success"))}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(o){}}),document.querySelector(".addSourceToListButton").addEventListener("click",()=>{document.querySelector(".addSourceToListForm").style.display="block"}),document.querySelector(".addSourceToListForm .fa-times").addEventListener("click",()=>{document.querySelector(".addSourceToListForm").style.display="none"}),document.querySelectorAll(".addSourceToListForm .saveButton").forEach(e=>{e.addEventListener("click",async()=>{let t=document.querySelector(".upperInnerContainer .sourceName").id.split("#")[1],r=[],i=[],o=[],n=e.parentElement.parentElement.querySelectorAll(".listContainer input");for(let s=0,c=n.length;s<c;s++)i.push(n[s].className),o.push(n[s].id.split("#")[1]);e.parentElement.previousElementSibling.querySelectorAll("input").forEach(e=>{e.checked?r.push("sourceInList"):r.push("sourceNotInList")});for(let a=0,l=r.length;a<l;a++)if(r[a]!=i[a]){if("sourceNotInList"==i[a]){let u=o[a];try{let d=await fetch(`../../api/lists/${u}/add_sources/${t}/`,get_fetch_settings("POST"));if(d.ok){let S=await d.json();showMessage(S,"Success"),window.location.reload()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(y){}}else try{let f=o[a],p=await fetch(`../../api/lists/${f}/delete_source_from_list/${t}/`,get_fetch_settings("DELETE"));if(p.ok){let h=await p.json();showMessage(h,"Success"),window.location.reload()}else showMessage("Error: Network request failed unexpectedly!","Error")}catch(b){}}})});